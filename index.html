<!DOCTYPE html>
<html lang="en">
</head>
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mikay's Salon - Beauty Services</title>
    <link rel="stylesheet" href="styless.css">
    <link rel="icon" href="transparent logo.png">
    <style>

        /* Basic styles for reviews (embedded for simplicity) */
        .reviews-list { max-width: 900px; margin: 0 auto; }
        .review-card { background: #fff; color: #111; padding: 1rem; margin-bottom: 0.75rem; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.08); }
        .review-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:0.5rem; }
        .review-name { font-weight:700; }
        .review-rating-display { color: #f5a623; margin-bottom:0.5rem; }
        .review-text { margin:0; }

    
    </style>
<body>
    <header id="header">
        <img src="transparent.jpg" alt="Mikay's Salon Logo" class="logo">
        <nav id="main-nav">
            <a href="#home">Home</a>
            <a href="#services">Services</a>
            <a href="#about">About Us</a>
            <a href="#reviews">Reviews</a>
        </nav>
        <button class="menu-toggle" aria-label="Toggle navigation" aria-expanded="false">
            <span class="bar"></span>
            <span class="bar"></span>
            <span class="bar"></span>
        </button>
    </header>

    <main>
        <section id="home">
            <div class="hero">
                <div class="hero-content">
                    <div class="hero-text">
                        <h1>Welcome to Mikay's Salon</h1>
                        <p>Where Beauty Meets Excellence. Experience luxury hair and nail services tailored just for you.</p>
                        
                        <div class="hero-buttons">
                            <a href="#services" class="btn btn-primary">View Services</a>
                        </div>
                    </div>
                    
                    <div class="service-gallery-wrapper">
                        <button class="gallery-btn prev-btn" aria-label="Previous image">❮</button>
                        <div class="service-gallery">

                            <div class="gallery-item">
                                <img src="hair 0.png" onerror="this.src='https://placehold.co/500x350/986253/F1EBE9?text=Hair+Styling'" alt="Hair Styling Service" class="gallery-image">
                                <div class="gallery-caption">Luxury Hair Services</div>
                            </div>
                            <div class="gallery-item">
                                <img src="hair 1.png" onerror="this.src='https://placehold.co/500x350/986253/F1EBE9?text=Hair+Styling'" alt="Hair Styling Service" class="gallery-image">
                                <div class="gallery-caption">Luxury Hair Services</div>
                            </div>
                            <div class="gallery-item">
                                <img src="hair 3.png" onerror="this.src='https://placehold.co/500x350/986253/F1EBE9?text=Hair+Styling'" alt="Hair Styling Service" class="gallery-image">
                                <div class="gallery-caption">Luxury Hair Services</div>
                            </div>
                            <div class="gallery-item">
                                <img src="hairhair.jpg" onerror="this.src='https://placehold.co/500x350/986253/F1EBE9?text=Hair+Styling'" alt="Hair Styling Service" class="gallery-image">
                                <div class="gallery-caption">Luxury Hair Services</div>
                            </div>
                            <div class="gallery-item">
                                <img src="haircut2.png" onerror="this.src='https://placehold.co/500x350/986253/F1EBE9?text=Hair+Styling'" alt="Hair Styling Service" class="gallery-image">
                                <div class="gallery-caption">Luxury Hair Services</div>
                            </div>
                            
                            <div class="gallery-item">
                                <img src="nail 1 (1).png" onerror="this.src='https://placehold.co/500x350/A47365/F1EBE9?text=Nail+Care'" alt="Manicure Service" class="gallery-image">
                                <div class="gallery-caption">Professional Nail Care</div>
                            </div>
                            <div class="gallery-item">
                                <img src="nail 1 (2).png" onerror="this.src='https://placehold.co/500x350/A47365/F1EBE9?text=Nail+Care'" alt="Manicure Service" class="gallery-image">
                                <div class="gallery-caption">Professional Nail Care</div>
                            </div>
                            <div class="gallery-item">
                                <img src="nail 1 (3).png" onerror="this.src='https://placehold.co/500x350/A47365/F1EBE9?text=Nail+Care'" alt="Manicure Service" class="gallery-image">
                                <div class="gallery-caption">Professional Nail Care</div>
                            </div>
                            <div class="gallery-item">
                                <img src="nail 1 (4).png" onerror="this.src='https://placehold.co/500x350/A47365/F1EBE9?text=Nail+Care'" alt="Manicure Service" class="gallery-image">
                                <div class="gallery-caption">Professional Nail Care</div>
                            </div>
                            <div class="gallery-item">
                                <img src="nail 1 (5).png" onerror="this.src='https://placehold.co/500x350/A47365/F1EBE9?text=Nail+Care'" alt="Manicure Service" class="gallery-image">
                                <div class="gallery-caption">Professional Nail Care</div>
                            </div>
                            
                        </div>
                        <button class="gallery-btn next-btn" aria-label="Next image">❯</button>
                    </div>
                </div>
            </div>
        </section>

        <section id="services">
            <div class="container">
                <h1>Our Services</h1>
                <p>Your beauty is our duty. Experience top-notch salon services tailored just for you. Here are the options for our services.</p>
                
                <div class="service-options">
                    
                    <div class="service-option-card">
                        <h2>Rebond</h2>
                        <p class="service-price">Price: ₱400</p>
                        <div class="service-gallery-wrapper">
                            <button class="gallery-btn prev-btn" aria-label="Previous image">❮</button>
                            <div class="service-gallery">
                                
                                <div class="gallery-item">
                                    <img src="hair 1.png" onerror="this.src='https://placehold.co/500x350/986253/F1EBE9?text=Hair+Styling'" alt="Hair Styling Service" class="gallery-image">
                                </div>
                                <div class="gallery-item">
                                    <img src="hair 3.png" onerror="this.src='https://placehold.co/500x350/986253/F1EBE9?text=Hair+Styling'" alt="Hair Styling Service" class="gallery-image">
                                </div>
                                <div class="gallery-item">
                                    <img src="hair 0.png" onerror="this.src='https://placehold.co/500x350/986253/F1EBE9?text=Hair+Styling'" alt="Hair Styling Service" class="gallery-image">
                                </div>
                                <div class="gallery-item">
                                    <img src="hairs.jpg" onerror="this.src='https://placehold.co/500x350/986253/F1EBE9?text=Hair+Styling'" alt="Hair Styling Service" class="gallery-image">
                                </div>
                            </div>
                            <button class="gallery-btn next-btn" aria-label="Next image">❯</button>
                        </div>
                    </div>
                    
                    <div class="service-option-card">
                        <h2>Hair color</h2>
                        <p class="service-price">Price: ₱250</p>
                        <div class="service-gallery-wrapper">
                            <button class="gallery-btn prev-btn" aria-label="Previous image">❮</button>
                            <div class="service-gallery">
                                <div class="gallery-item">
                                    <img src="haircolor.jpg" onerror="this.src='https://placehold.co/500x350/986253/F1EBE9?text=Hair+Styling'" alt="Hair Styling Service" class="gallery-image">
                                    <div class="gallery-caption"></div>
                                </div>
                                <div class="gallery-item">
                                    <img src="haircolor2.jpg" onerror="this.src='https://placehold.co/500x350/986253/F1EBE9?text=Hair+Styling'" alt="Hair Styling Service" class="gallery-image">
                                    <div class="gallery-caption"></div>
                                    
                                </div>
                                <div class="gallery-item">
                                    <img src="haircolor3.jpg" onerror="this.src='https://placehold.co/500x350/986253/F1EBE9?text=Hair+Styling'" alt="Hair Styling Service" class="gallery-image">
                                    <div class="gallery-caption"></div>
                                    
                                </div>
                            </div>
                            <button class="gallery-btn next-btn" aria-label="Next image">❯</button>
                        </div>
                    </div>

                    <div class="service-option-card">
                        <h2>manicure</h2>
                        <p class="service-price">Price: ₱200</p>
                        <div class="service-gallery-wrapper">
                            <button class="gallery-btn prev-btn" aria-label="Previous image">❮</button>
                            <div class="service-gallery">
                                <div class="gallery-item">
                                    <img src="nail 1 (1).png" onerror="this.src='https://placehold.co/500x350/A47365/F1EBE9?text=Nail+Care'" alt="Manicure Service" class="gallery-image">
                                    <div class="gallery-caption"></div>
                                </div>
                                <div class="gallery-item">
                                    <img src="nail 1 (2).png" onerror="this.src='https://placehold.co/500x350/A47365/F1EBE9?text=Nail+Care'" alt="Manicure Service" class="gallery-image">
                                </div>
                                <div class="gallery-item">
                                    <img src="nail 1 (3).png" onerror="this.src='https://placehold.co/500x350/A47365/F1EBE9?text=Nail+Care'" alt="Manicure Service" class="gallery-image">
                                </div>
                                <div class="gallery-item">
                                    <img src="nails1.jpg" onerror="this.src='https://placehold.co/500x350/A47365/F1EBE9?text=Nail+Care'" alt="Manicure Service" class="gallery-image">
                                </div>
                            </div>
                            <button class="gallery-btn next-btn" aria-label="Next image">❯</button>
                        </div>
                    </div>

                    <div class="service-option-card">
                        <h2>pedicure</h2>
                        <p class="service-price">Price: ₱200</p>
                        <div class="service-gallery-wrapper">
                            <button class="gallery-btn prev-btn" aria-label="Previous image">❮</button>
                            <div class="service-gallery">
                                <div class="gallery-item">
                                    <img src="pedicure.jpg" onerror="this.src='https://placehold.co/500x350/A47365/F1EBE9?text=Nail+Care'" alt="Manicure Service" class="gallery-image">   
                                </div>
                                <div class="gallery-item">
                                    <img src="pedicure2.jpg" onerror="this.src='https://placehold.co/500x350/A47365/F1EBE9?text=Nail+Care'" alt="Manicure Service" class="gallery-image">
                                </div>
                            </div>
                            <button class="gallery-btn next-btn" aria-label="Next image">❯</button>
                        </div>
                    </div>

                </div>
            </div>
        </section>
        <section id="about">
            <div class="container">
                <h1>About Us</h1>
                <div class="about-content">
                    <div class="about-quote">
                        <blockquote>"Whoever you are, whatever you do, we bring out the best in you."</blockquote>
                        <p>Mikay's Salon offers a safe environment and trustworthy service. We take pride in providing the highest quality of service at prices everyone can afford. Total customer satisfaction is our goal.</p>
                    </div>
                    <div class="about-item">
                        
                        <img src="images/ate.jpg" alt="Michaela Regala" class="about-img">
                        <h2>Owner: Michaela Regala</h2>
                        <p><strong>Michaela Joy Regala</strong> was exposed to hairdressing and manicure at a young age. She started her business at the age of 18 to provide for her parents, proving that hard work and passion can lead to success.</p>
                    </div>
                    
                    <div class="about-item">
                        <img src="kuya ron.jpg" alt="Daniel Dalmacio" class="about-img">
                        <h2>Assistant/Partner: Daniel Dalmacio</h2>
                        <p>Daniel Dalmasio is a kind-hearted man who loves to socialize, an ideal partner for a business. Not only is he good at bringing customers, he also ensures smooth operations and positive client relations.</p>
                    </div>

                    <div class="about-item">
                        <img src="me.jpg" alt="Daniel Dalmacio" class="about-img">
                        <h2>Assistant/Partner: Paulo Regala</h2>
                        <p>Michaela Regala's younger brother who sometimes help and bring customers to the business. an well manered young man with a bright future.</p>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="reviews" class="reviews-section">
            <div class="container">
                <h1 class="text-center">Client Reviews</h1>
                <p class="text-center subtitle">See what our happy clients have to say about their experience</p>

                <div class="review-form-card">
                    <h2>Leave a Review</h2>
                    <form id="review-form">
                        <div class="form-group">
                            <label for="review-name">Your Name</label>
                            <input type="text" id="review-name" placeholder="Enter your name" required>
                        </div>

                        <div class="form-group">
                            <label>Rating</label>
                            <div id="rating-stars" class="rating-stars" data-rating="0">
                                <span data-value="5">★</span>
                                <span data-value="4">★</span>
                                <span data-value="3">★</span>
                                <span data-value="2">★</span>
                                <span data-value="1">★</span>
                            </div>
                            <input type="hidden" id="review-rating" required data-rating-input>
                        </div>

                        <div class="form-group">
                            <label for="review-text">Your Review</label>
                            <textarea id="review-text" rows="4" placeholder="Share your experience with us..." required></textarea>
                        </div>

                        <button type="submit" class="btn btn-primary" id="submit-review-btn">Submit Review</button>
                    </form>
                </div>
                
                        <div id="auth-status" class="text-center text-sm mt-4"></div>

                        <!-- Reviews List (populated from Firestore or IndexedDB) -->
                        <div id="reviews-list" class="reviews-list mt-6" aria-live="polite">
                            <!-- Filled by JS -->
                            <p id="loading-reviews" class="text-center text-secondary">Loading reviews...</p>
                        </div>
            </div>
        </section>
        
    </main>

    <footer id="footer">
        <div class="footer-content">
            <div class="footer-section contact-info">
                <h3>Contact Us</h3>
                <img src="Gmail_Logo_512px.png" height="40" width="40" alt=""><p>Email: <a href="mailto:info@regalapaulo22@gmail.com">info@mikayssalon.com</a></p>
                <img src="phone-call.png" height="40" width="40" alt="call"><p>Phone: <a href="tel:+639123456789">+63 912 345 6789</a></p>
                <p>Address: TowerGrottoVille, San Jose Del Monte City, PH</p>
            </div>
            
            <div class="footer-section quick-links">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="#home">Home</a></li>
                    <li><a href="#services">Services</a></li>
                    <li><a href="#about">About Us</a></li>
                    <li><a href="#">Privacy Policy</a></li>
                </ul>
            </div>
            
            <div class="footer-section follow-us">
                <h3>Follow Us</h3>
                <div class="social-icons">

                    <a href="https://www.facebook.com/itsme.myselfnI018" target="_blank" aria-label="Facebook Profile"><img src="fb.png" alt="TikTok" height="50" width="50">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    
                    <a href="https://www.instagram.com/_micakesz/" target="_blank" aria-label="Instagram Profile"><img src="ig.png" alt="TikTok" height="50" width="50">
                        <i class="fab fa-instagram"></i>
                    </a>
                    
                    <a href="https://www.tiktok.com/@its.mikay_18" target="_blank" aria-label="TikTok Profile"><img src="vecteezy_tiktok-png-icon_16716450.png" alt="TikTok" height="50" width="50">
                        <i class="fab fa-tiktok"></i>
                    </a>
                </div>
                <p class="update-notice"></p>
            </div>
            
        </div>
        
        <div class="footer-bottom">
            Made with <span>&hearts;</span> by Mikay's Salon &copy; 2025. All rights reserved.
        </div>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, onSnapshot, addDoc, serverTimestamp, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        setLogLevel('Debug');

        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');

        let db, auth, userId = null;

        const menuToggle = document.querySelector('.menu-toggle');
        const nav = document.getElementById('main-nav');

        const toggleMenu = () => {
            const isExpanded = menuToggle.getAttribute('aria-expanded') === 'true';
            nav.classList.toggle('active');
            menuToggle.classList.toggle('active');
            menuToggle.setAttribute('aria-expanded', !isExpanded);
            document.body.classList.toggle('menu-open', !isExpanded);
        };

        menuToggle.addEventListener('click', toggleMenu);

        nav.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', () => {
                if (nav.classList.contains('active')) {
                    toggleMenu();
                }
            });
        });
        window.addEventListener('resize', () => {
            if (window.innerWidth > 768) {
                nav.classList.remove('active');
                menuToggle.classList.remove('active');
                menuToggle.setAttribute('aria-expanded', 'false');
                document.body.classList.remove('menu-open');
            }
        });

        const initGallery = (wrapper) => {
            if (!wrapper) return;
            const gallery = wrapper.querySelector('.service-gallery');
            const prevBtn = wrapper.querySelector('.prev-btn');
            const nextBtn = wrapper.querySelector('.next-btn');

            if (!gallery || !prevBtn || !nextBtn) return;

            const scrollGallery = (direction) => {
                const scrollDistance = direction * gallery.clientWidth;
                gallery.scrollBy({
                    left: scrollDistance,
                    behavior: 'smooth'
                });
            };

            prevBtn.addEventListener('click', () => scrollGallery(-1));
            nextBtn.addEventListener('click', () => scrollGallery(1));
        };

        document.querySelectorAll('.service-gallery-wrapper').forEach(initGallery);
        const initFirebase = async () => {
            try {
                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);
                
                const authStatusEl = document.getElementById('auth-status');
                
                onAuthStateChanged(auth, async (user) => {
                    if (user) {
                        userId = user.uid;
                        authStatusEl.textContent = `User Authenticated. ID: ${userId}`;
                        console.log("Firebase Auth Ready. User ID:", userId);
                        setupReviewListener();
                    } else {
                        
                        if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                            await signInWithCustomToken(auth, __initial_auth_token);
                        } else {
                            await signInAnonymously(auth);
                        }
                    }
                });

            } catch (error) {
                console.error("Error during Firebase initialization or sign-in:", error);
                document.getElementById('loading-reviews').textContent = 'Error loading reviews. Please check console for details.';
            }
        };

        const renderStars = (rating) => {
            const fullStar = '★'; 
            const emptyStar = '☆'; 
            let stars = '';
            for (let i = 1; i <= 5; i++) {
                stars += (i <= rating ? fullStar : emptyStar);
            }
            return `<span class="star-display">${stars}</span>`;
        };

        const setupRatingInput = () => {
            const ratingContainer = document.getElementById('rating-stars');
            const ratingInput = document.getElementById('review-rating');
            const stars = ratingContainer.querySelectorAll('span');

            const setActive = (rating) => {
                stars.forEach(star => {
                    const starValue = parseInt(star.dataset.value);
                    star.classList.toggle('active', starValue <= rating);
                });
                ratingInput.value = rating;
                ratingContainer.dataset.rating = rating;
            };

            stars.forEach(star => {
                star.addEventListener('mouseover', () => {
                    const value = parseInt(star.dataset.value);
                    stars.forEach(s => {
                        s.classList.toggle('hover', parseInt(s.dataset.value) <= value);
                    });
                });

                star.addEventListener('mouseout', () => {
                    stars.forEach(s => s.classList.remove('hover'));
                });

                star.addEventListener('click', () => {
                    const value = parseInt(star.dataset.value);
                    setActive(value);
                });
            });
            
            setActive(5); 
        };

        const setupReviewListener = () => {
            if (!db) {
                console.error("Firestore not initialized.");
                return;
            }
            
            const reviewsRef = collection(db, `artifacts/${appId}/public/data/reviews`);
            
            onSnapshot(reviewsRef, (snapshot) => {
                const reviews = [];
                snapshot.forEach(doc => {
                    reviews.push({ id: doc.id, ...doc.data() });
                });
                
                reviews.sort((a, b) => (b.timestamp?.seconds || 0) - (a.timestamp?.seconds || 0));
                
                displayReviews(reviews);
            }, (error) => {
                console.error("Error listening to reviews:", error);
                document.getElementById('loading-reviews').textContent = 'Failed to load reviews.';
            });
        };

        const displayReviews = (reviews) => {
            const reviewsListEl = document.getElementById('reviews-list');
            reviewsListEl.innerHTML = ''; 
            
            if (reviews.length === 0) {
                reviewsListEl.innerHTML = '<p class="text-center text-secondary">No reviews yet. Be the first to share your experience!</p>';
                return;
            }

            reviews.forEach(review => {
                const date = review.timestamp ? new Date(review.timestamp.seconds * 1000).toLocaleDateString() : 'N/A';
                
                const reviewCard = document.createElement('div');
                reviewCard.className = 'review-card';
                reviewCard.innerHTML = `
                    <div class="review-header">
                        <span class="review-name">${review.userName}</span>
                        <span class="review-date">${date}</span>
                    </div>
                    <div class="review-rating-display">${renderStars(review.rating)}</div>
                    <p class="review-text">${review.reviewText}</p>
                `;
                reviewsListEl.appendChild(reviewCard);
            });
        };

        /* -------- IndexedDB fallback for reviews (when Firestore not available) -------- */
        const IDB_DB_NAME = 'mikays_reviews_db';
        const IDB_STORE = 'reviews';

        function openIDB() {
            return new Promise((resolve, reject) => {
                if (!('indexedDB' in window)) return resolve(null);
                const req = indexedDB.open(IDB_DB_NAME, 1);
                req.onupgradeneeded = (e) => {
                    const db = e.target.result;
                    if (!db.objectStoreNames.contains(IDB_STORE)) {
                        db.createObjectStore(IDB_STORE, { keyPath: 'id', autoIncrement: true });
                    }
                };
                req.onsuccess = (e) => resolve(e.target.result);
                req.onerror = (e) => reject(e.target.error);
            });
        }

        async function idbAddReview(obj) {
            const db = await openIDB();
            if (!db) return;
            return new Promise((resolve, reject) => {
                const tx = db.transaction(IDB_STORE, 'readwrite');
                const store = tx.objectStore(IDB_STORE);
                const req = store.add({ ...obj, savedAt: Date.now() });
                req.onsuccess = () => resolve(req.result);
                req.onerror = () => reject(req.error);
            });
        }

        async function idbGetAll() {
            const db = await openIDB();
            if (!db) return [];
            return new Promise((resolve, reject) => {
                const tx = db.transaction(IDB_STORE, 'readonly');
                const store = tx.objectStore(IDB_STORE);
                const req = store.getAll();
                req.onsuccess = () => resolve(req.result || []);
                req.onerror = () => reject(req.error);
            });
        }

        // Try to load local IDB reviews and display them when Firestore isn't available.
        async function loadLocalReviews() {
            try {
                const local = await idbGetAll();
                if (local && local.length) {
                    // Map to same shape used by displayReviews
                    const mapped = local.map(r => ({ userName: r.userName, rating: r.rating, reviewText: r.reviewText, timestamp: { seconds: Math.floor((r.savedAt || Date.now()) / 1000) } }));
                    displayReviews(mapped);
                } else {
                    document.getElementById('loading-reviews').textContent = 'No reviews yet.';
                }
            } catch (err) {
                console.error('Error loading local reviews', err);
            }
        }


        const handleReviewSubmission = async (e) => {
            e.preventDefault();

            const submitButton = document.getElementById('submit-review-btn');
            submitButton.disabled = true;
            submitButton.textContent = 'Submitting...';

            const userName = document.getElementById('review-name').value.trim();
            const rating = parseInt(document.getElementById('review-rating').value);
            const reviewText = document.getElementById('review-text').value.trim();

            if (!userName || rating < 1 || rating > 5 || !reviewText) {
                console.error("Validation failed.");
                submitButton.disabled = false;
                submitButton.textContent = 'Submit Review';
                showModal('Validation', 'Please fill in all required fields and choose a rating.');
                return;
            }

            try {
                if (db && typeof addDoc === 'function') {
                    const reviewsRef = collection(db, `artifacts/${appId}/public/data/reviews`);
                    await addDoc(reviewsRef, {
                        userId: userId || null,
                        userName: userName,
                        rating: rating,
                        reviewText: reviewText,
                        timestamp: serverTimestamp()
                    });
                    showModal('Success!', 'Thank you for your review. It has been submitted successfully.');
                } else {
                    // Firestore not available; save to IndexedDB
                    await idbAddReview({ userName, rating, reviewText });
                    showModal('Saved Locally', 'Your review was saved locally and will appear on the site.');
                    await loadLocalReviews();
                }

                document.getElementById('review-form').reset();
                setupRatingInput();

            } catch (error) {
                console.error("Error submitting review:", error);
                showModal('Submission Error', 'Could not submit review. Please try again later.');
            } finally {
                submitButton.disabled = false;
                submitButton.textContent = 'Submit Review';
            }
        };

        const showModal = (title, message) => {
            const modal = document.createElement('div');
            modal.className = 'custom-modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <h3 class="modal-title">${title}</h3>
                    <p class="modal-message">${message}</p>
                    <button class="btn btn-primary modal-close-btn">Close</button>
                </div>
            `;
            document.body.appendChild(modal);

            const close = modal.querySelector('.modal-close-btn');
            close.addEventListener('click', () => {
                modal.remove();
            });
            
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        };
        
        window.addEventListener('load', () => {
            initFirebase();
            setupRatingInput();
            document.getElementById('review-form').addEventListener('submit', handleReviewSubmission);

            // If Firestore isn't configured or takes time, load local reviews as fallback
            setTimeout(() => {
                if (!db) loadLocalReviews();
            }, 700);
        });
    </script>
</body>
</html>